@* @using dock *@
@using macOs.Applications.AppList
@rendermode InteractiveServer

<div class="finder-window" style="@($"top: {posY}px; left: {posX}px;")" @onmousemove="HandleMouseMove"
    @onmouseup="EndDrag">
    <div class="finder-header" @onmousedown="StartDrag">
        <div class="buttons" @onmousedown="StartDrag">
            <span class="close" @onclick="CloseSafari"></span>
            <span class="maximize" @onclick="ToggleMaximize"></span>
        </div>
        <span class="title">Safari</span>
    </div>
    <iframe src="https://www.google.com" style="width: 100%; height: 100%; border: none;"></iframe>
</div>


@code {
    private double posX = 200, posY = 100;
    private double startX, startY;
    private bool isDragging = false;
    public static bool closeSafari = false;

    private void StartDrag(MouseEventArgs e)
    {
        isDragging = true;
        startX = e.ClientX - posX;
        startY = e.ClientY - posY;
    }

    private void HandleMouseMove(MouseEventArgs e)
    {
        if (isDragging)
        {
            posX = e.ClientX - startX;
            posY = e.ClientY - startY;
        }
    }

    private void EndDrag()
    {
        isDragging = false;
    }

    public static void CloseSafari()
    {
        closeSafari = true;
        macOs.Components.Layout.Dock.CloseApp();
        Console.WriteLine("Safari Closed");
    }

    private void ToggleMaximize()
    {
        Console.WriteLine("SAfari Maximized/Restored");
    }
}